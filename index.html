<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Location</title>
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css'>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css' integrity='sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==' crossorigin='anonymous' referrerpolicy='no-referrer' />

  <style>
    .center {
      width: 100%;
      height: 100%;
      position: fixed;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    .arrow {
      margin-top: 1rem;
      width: 20px;
      height: 60px;
      background-color: cornflowerblue;
      border-radius: 12px 12px 0px 0;
    }
  </style>
</head>
<body>
  <div class="p-4 center">
    <p class="title" id="x">X Rotation</p>
    <p class="title" id="y">Y Rotation</p>
    <p class="title" id="z">Z Rotation</p>

    <p class="title" id="location"></p>

    <div class="arrow"></div>

    <p class="title" id="lat"></p>
    <p class="title" id="lon"></p>
  </div>

  <script>
    
    const locationData = [
      {
        name: "Sheetal Restaurant",
        latitude: 18.5023979,
        longitude: 73.8160468,
        tolerance: 0.0000659
      },
      {
        name: "Kumar Parisar C-2",
        latitude: 18.498932699245525,
        longitude: 73.80233292355648,
        tolerance: 0.00009530075447
      },
      {
        name: "Kumar Parisar D",
        latitude: 18.4982001,
        longitude: 73.8020911,
        tolerance: 0.497998864592137
      },
      {
        name: "Dominos Pizza",
        latitude: 18.5022102,
        longitude: 73.8157836,
        tolerance: 0.50224560279233
      },
    ]


    navigator.geolocation.watchPosition(showLocation)
    
    if (window.DeviceOrientationEvent) {
      window.addEventListener("deviceorientation", (e) => {
        
        var x = e.beta
        var y = e.gamma
        var z = e.alpha

        document.getElementById("x").textContent = `X: ${x.toFixed()}`
        document.getElementById("y").textContent = `Y: ${y.toFixed()}`
        document.getElementById("z").textContent = `Z: ${z.toFixed()}`

        const location = 173

        document.querySelector(".arrow").style.transform = `rotate(${-location - (-z)}deg)`
      })
    } else {
      console.log("DeviceOrientation not supported");
    }

    function showLocation(position) {
      
      const latitude = position.coords.latitude
      const longitude = position.coords.longitude

      var latTrue = false
      var lonTrue = false

      document.getElementById("lat").textContent = latitude
      document.getElementById("lon").textContent = longitude

      // const location = locationData[1]

      locationData.map((location) => {
        if (latitude < (location.latitude + location.tolerance) || latitude < (location.latitude - location.tolerance)) {
          latTrue = true
        } else {
          latTrue = false
        }
  
        if (longitude < (location.longitude + location.tolerance) || longitude < (location.longitude - location.tolerance)) {
          lonTrue = true
        } else {
          lonTrue = false
        }
  
        if (lonTrue && latTrue) {
          document.getElementById("location").textContent = locationData[1].name
        } else {
          document.getElementById("location").textContent = "Not in location"
        }
      })
    }
  </script>
</body>
</html>